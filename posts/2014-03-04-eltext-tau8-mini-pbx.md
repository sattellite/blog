---
tags: eltex, voip
noedit: true
---

# Офисная Мини-АТС на базе Eltex TAU-8.IP

Пришел на тест русский VoIP-шлюз - [Eltex TAU-8.IP](http://eltex.nsk.ru/product/tau-8ip). По словам производителей разрабатывался он как замена Linksys SPA8000 и на данный момент работает даже лучше. На сегодня железка на рынке уже более 2 лет, что может говорить только о том, что практически все ошибки давно исправлены и она является готовым к использованию продуктом.

Сейчас попробуем на его базе сделать офисную мини-АТС.

![](/images/tau-8_right.png)

***Оффтопик***: Шлюз не то что тихий, а абсолютно бесшумный, если сравнивать с Linksys SPA8000. Охлаждение пассивное воздушное. Выглядит симпатично, но будь угловатым - был бы стильным решением, как и qTech QVI-2102 rev.3, только большего размера.

Из интересующего нас функционала:

- Внутренние номера
- Распределение входящих вызовов по внутренним номерам
- Выход во вне определенным портам

Максимум, что можно получить - 8 внутренних номеров, очередь входящих вызвов, перехват вызовов.

### Настройка SIP
В разделе *PBX* выбираем вкладку *SIP* и *Профили SIP*. Существует один профиль по умолчанию - **SIP profile 0**. Отредактируем его: включим использование прокси и регистрации, пропишем адрес proxy-сервера, который по совместительству и registrar является. Еще можно включить опцию `183 Progress (Early media)`, чтобы вместо стандартных гудков приходил медиа-поток с вызываемой стороны, если он там присутствует (например, мелодия при вызове на мобильный) .
![](/images/tau-8_sip1.png)

Настраиваем необходимые кодеки, опции определения факсов. Тут все зависит от провайдера.
![](/images/tau-8_sip2.png)

Теперь нужно настроить диалплан таким образом, чтобы это все корректно заработало и предоставляло функционал, необходимый для офисной мини-АТС. Собственно, здесь и происходит вся магия.
![](/images/tau-8_sip3.png)

Прямо в интерфейсе есть хорошее объяснение работы диалплана. Но возникают местами вопросы. Техническая поддержка у Eltex отличная и со всеми проблемами поможет быстро разобраться.

А сейчас, про не совсем очевидные проблемы, которые могут возникнуть:

- Правила устанавливаются по нарастающей
- Все правила определяются внутри одной группы скобок и разделяются между собой вертикальной чертой `|`
- Правило звонков внутри АТС, которое через `@{local}`, вероятно, должно стоять самым первым
- Таймеры *Short* и *Long* работают по не до конца понятной логике

Из данного диалплана можно вывести следующее:

- **S2** - время ожидания нажатия следующей клавиши, после которого происходит поиск оптимального правила диалплана
- **L8** - время, по истечению которого не нажималась более ни одна клавиша,  произойдет окончательное определение правила диалплана и будет произведена отправка номера согласно определенному правилу
- **0x** - номера спец.служб
- **xxx@{local}** - вызов трехзначных номеров внутри устройства, которые мы определим чуть позже
- **xxxxxx** - шестизначные городские номера
- **8,xxxxxxxxxx** - мобильные и междугородние номера, после набора 8 выдать сигнал в линию
- **8,10,x+** - междугородние номера, после набора 8 выдать сигнал, после набора 10 снова выдать сигнал в линию, а далее принимаем любое количество цифр

### Внутренние номера.
По умолчанию внутренняя нумерация установлена в промежутке 001 - 008 по портам соответственно. Мне привычнее нумерация, начинающаяся с 100.

В разделе ***PBX*** выбираем вкладку ***FXS***. В поля *Номер телефона* и *Номер пользователя* вписываем номера, которые хотим присвоить внутренним абонентам. На портах абонентов, которым необходимо разрешить выход в город вставляем в поле ***Логин*** номер городского телефона, включаем опцию ***Альтернативный номер*** и в ее значение снова вписываем городской номер. В поле ***Пароль*** необходимо вписать пароль от городского номера.
![](/images/tau-8_fxs.png)

### Группы вызова
Теперь определим абонентов, на которых будет поступать входящий вызов. Для этого в разделе ***PBX*** выбираем вкладку ***Группы вызова***.
Создаем новую группу и редактируем ее.
Делаем активной, даем название. В SIP-профиле выбираем необходимый SIP-профиль, но в данном случае он один. Задаем логин-пароль для регистрации номера у провайдера, определяем тип прохождения звонков по внутренним абонентам, размер очереди и, самое главное, таймаут неответа на поступивший вызов. Оптимальным будет значение в 180 секунд, т.к. обычно в течении 3 минут один из принимающих вызовы уже освободится и примет следующий вызов.

Можно разрешить перехват входящего вызова на группу. Для этого придется настраивать группы перехвата и в диалплан прописать правило для перехвата для группы **X** `@{pickup:X}`.
![](/images/tau-8_group.png)

После всех манипуляций не забываем нажать ***Применить***, подождать несколько секунд и можно работать с мини-АТС.

Вот такими простыми движениями можно легко создать бюджетную IP-АТС полностью покрывающую нужды маленького офиса. В целом подобная конфигурация не должна вызвать проблем, тем более что во время настройки везде будут описания каждой опции, которую можно изменить.

